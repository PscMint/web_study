应用场景介绍：在json转化为对象的过程中可能会出现各种异常，有些系统中有，但有些异常则是需要符合业务处理的逻辑。

异常机制科普：没有被处理的异常（Uncaught）会被显示在控制台上

```js
// good json
let json_good=`{
"name":"Lily",
"age":22
}`
//bad json
let json_bad_1=`{
"bad json"
}`
let json_bad_2=`{
"name":"Lily"
}`

//构造异常
class ValidationError extends Error{
    constructor(message){
        super(message)
        this.name=this.constructor.name;
        
    }
}
//自定义异常的拓展
class NoPropertyError extends ValidationError{
    constructor(property){
        super("No property:"+property);
        this.property=property;
    }
}


//读取json函数,根据读取的情况抛出相应的异常
function readUser(json){
    let user=JSON.parse(json);
    if(!user.name)
        throw new ValidationError("No Field:name");
    if(!user.age)
        throw new ValidationError("No Field:age");
    return user;
}
function readUser2(json){
    let user=JSON.parse(json);
    if(!user.name)
        //这个新的异常直接通过变量名生成错误信息
        throw new NoPropertyError("name");
    if(!user.age)
        throw new NoPropertyError("age");
    return user;
}

//在调用函数的过程中进行异常的捕获
try{
    let user=readUser2(json_bad_2)
}
catch(err){
    //可以处理的异常，提示错误信息
    if(err instanceof ValidationError)
        alert("Invalid data: "+err.message)
    else if(err instanceof SyntaxError)
        alert("JSON SyntaxError: "+err.message)
    //处理不了的异常，抛给控制台
    else{
        throw err;
    }
    
}

```

```js
// good json
let json_good=`{
"name":"Lily",
"age":22
}`
//bad json
let json_bad_1=`{
"bad json"
}`
let json_bad_2=`{
"name":"Lily"
}`

//构造异常
class ValidationError extends Error{
    constructor(message){
        super(message)
        this.name=this.constructor.name;
        
    }
}
//自定义异常的拓展
class NoPropertyError extends ValidationError{
    constructor(property){
        super("No property:"+property);
        this.property=property;
    }
}
//定义readError类，方便在异常捕获的时候可以少捕获一些种类
class readError extends Error{
    constructor(message,cause){
        super(message)
        //保存错误对象
        this.cause=cause;
        this.name=this.constructor.name;
    }
}

//读取json函数,根据读取的情况抛出相应的异常
function validateUser(user){
    if(!user.name)
        //这个新的异常直接通过变量名生成错误信息
        throw new NoPropertyError("name");
    if(!user.age)
        throw new NoPropertyError("age");
}


function readUser(json){
    let user;
    try{
    user=JSON.parse(json);
    }catch(err){
        if(err instanceof SyntaxError)
            throw new readError("JSON SyntaxError",err)
        else
            throw err;
    }

    try{
        validateUser(user)
    }catch(err){
        if(err instanceof ValidationError)
            throw new readError("NoPropertyError",err)
        else
            throw err;
    }
    
    return user;
}
//在调用函数的过程中进行异常的捕获，只需要readError即可，这个错误里面有其他的错误对象
try{
    readUser(json_bad_2)
}
catch(err){
    if(err instanceof readError)
        alert(err.message)
        console.log(err.cause)
}
```

